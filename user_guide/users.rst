пользователей
=============

Типы пользователей
------------------

В Канборде могут быть два типа пользователей:

+------------+---------------------------------------------------------+
| Тип        | Описание                                                |
+============+=========================================================+
| Локальный  | Пароль пользователя хранится в базе данных Канборда     |
| пользовате |                                                         |
| ль         |                                                         |
+------------+---------------------------------------------------------+
| Удаленный  | Учетные данные пользователя управляются                 |
| пользовате | (контролируются) другой системой (например, LDAP        |
| ль         | сервер). Другими словами, аутентификация пользователя   |
|            | происходит во внешней системе, не в Канборде.           |
+------------+---------------------------------------------------------+

Примеры удаленных пользователей:

-  LDAP пользователь
-  Аутентификация пользователя через реверс-прокси

Пользовательские роли
---------------------

Роли в приложениях
~~~~~~~~~~~~~~~~~~

Каждый пользователь системы Канборд имеет одну из этих ролей

+--------------+-------------------------------------------------------+
| Роль         | Описание                                              |
+==============+=======================================================+
| Администрато | Имеет доступ ко всему                                 |
| р            |                                                       |
+--------------+-------------------------------------------------------+
| Менеджер     | Может создавать командные проекты, но не может        |
|              | изменять настройки приложения                         |
+--------------+-------------------------------------------------------+
| Пользователь | Может создавать только приватные проекты              |
+--------------+-------------------------------------------------------+

Роли в проектах
~~~~~~~~~~~~~~~

В каждом командном проекте могут быть назначены разные роли для
пользователей и групп:

+---------------+------------------------------------------------------+
| Роль          | Описание                                             |
+===============+======================================================+
| Менеджер      | Может изменять настройки проекта, имеет доступ к     |
| проекта       | диаграмме Ганта и отчетам                            |
+---------------+------------------------------------------------------+
| Участник      | Может создавать задачи и пользоваться доской         |
| проекта       |                                                      |
+---------------+------------------------------------------------------+
| Наблюдатель   | Имеет доступ к доске и задачам только на просмотр    |
| проекта       | (чтение)                                             |
+---------------+------------------------------------------------------+

Управление группами
-------------------

В Канборде каждый пользователь может быть членом одной или нескольких
групп. Группа - это что-то вроде команды или организации.

Только администраторы могут создавать новую группу и добавлять туда
пользователей.

Настройка групп доступна через **Управление пользователями** (выпадающее
меню справа вверху) -> **Просмотр всех пользователей**. Здесь вы можете
создавать новые группы и добавлять пользователей в группы.

.. figure:: /_static/groups-management.png
   :alt: Group Management

Управление группами.

Менеджеры проектов могут предоставлять доступ группам к проектам на
странице Разрешения проекта.

Внешние id в основном используются для предоставления доступа внешним
группам. Канборд поддерживает группы из LDAP посредством автоматической
синхронизации групп из LDAP сервера.

Создание нового пользователя
----------------------------

Только администратор может создавать нового пользователя.

1. В выпадающем меню, в правом верхнем углу, выберите **Управление
   пользователями**
2. Вверху имеются ссылки - **Новый локальный пользователь** и **Новый
   удаленный пользователь**
3. При создании пользователя нужно заполнить форму и сохранить

.. figure:: /_static/new-user.png
   :alt: New user

Форма создания нового пользователя.

При создании **Локального пользователя** вы должны, как минимум,
заполнить следующие поля:

-  **Имя пользователя**: это поле является уникальным идентификатором
   вашего пользователя (логин)
-  **Пароль**: Пароль пользователя должен иметь минимум 6 символов

Для **удаленных пользователей** обязательно только **Имя пользователя**.

Редактирование пользователей
----------------------------

После перехода в **Управление пользователями**, вам будет доступен
список пользователей. Кликните на пользователя в столбце **Имя
пользователя**. Далее, вам будет доступно редактирование настроек и
профиля пользователя.

-  Если вы имеете права пользователя, то вы сможете только изменить ваш
   профиль
-  Для редактирования любого пользователя вам должны быть назначены
   права администратора

Удаеление пользователей
-----------------------

В списке пользователей выберите в колонке **Действия** в выпадающем меню
**Удалить**. Эта ссылка доступна только для администраторов.

Если вы удалите пользователя, то все задачи назначенные пользователю
перестанут быть назначенными.

Двухфакторная аутентификация
----------------------------

Любой пользователь может включить `двух-уровневую
аутентификацию <http://ru.wikipedia.org/wiki/Многофакторная_аутентификация>`__.
После успешного входа, разовый код (6 знаков) запрашивается у
пользователя для получения доступа в Канборд.

Этот код присылается в программу на вашем смартфоне.

Канборд использует `Time-based One-time Password
Algorithm <http://ru.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm>`__
основанный на `RFC 6238 <http://tools.ietf.org/html/rfc6238>`__.

Имеется много программ совместимых со стандартной системой TOTP.
Например, вы можете использовать эти приложения, бесплатные и с открытым
исходным кодом:

-  `Google
   Authenticator <https://github.com/google/google-authenticator/>`__
   (Android, iOS, Blackberry)
-  `FreeOTP <https://freeotp.github.io/>`__ (Android, iOS)
-  `OATH Toolkit <http://www.nongnu.org/oath-toolkit/>`__ (Command line
   utility on Unix/Linux)

Эти системы могут работать офлайн и вам не нужно иметь мобильную связь.

Настройка
~~~~~~~~~

1. Перейдите в пользовательский профиль
2. Слева нажмите **Двухфакторная авторизация** и поставьте галочку в
   чекбоке
3. Секретный ключ сгенерируется для вас

.. figure:: /_static/2fa.png
   :alt: 2FA

Двухфакторная аутентификация.

-  Вы должны сохранить секретный ключ в вашей TOTP программе. Если вы
   используете сматрфон, то просто сосканируйте QR код с помощью FreeOTP
   или Google Authenticator.
-  Каждый раз, когда вы будете входить в Канборд, будет запрашиваться
   новый код
-  Не забудьте протестировать ваше устройство, перед тем как закрыть
   вашу сессию

Новый секретный ключ генерируется каждый раз при включении/выключении
этой возможности.
